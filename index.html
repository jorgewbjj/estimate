<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Orçamento</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        .total {
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
        }
        
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        .validade {
            margin-top: 30px;
            font-style: italic;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Orçamento</h1>
    </div>

    <div class="form-group">
        <label>Cliente:</label>
        <input type="text" id="cliente" required>
    </div>

    <div class="form-group">
        <label>Data:</label>
        <input type="date" id="data" required>
    </div>

    <h3>Materiais/Serviços</h3>
    <table id="itens">
        <thead>
            <tr>
                <th>Descrição</th>
                <th width="120">Preço Unitário</th>
                <th width="100">Quantidade</th>
                <th width="120">Subtotal</th>
                <th width="50"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="text" class="material"></td>
                <td><input type="number" class="preco" step="0.01"></td>
                <td><input type="number" class="quantidade" value="1"></td>
                <td class="subtotal">R$ 0.00</td>
                <td><button type="button" onclick="removerLinha(this)">×</button></td>
            </tr>
        </tbody>
    </table>

    <button type="button" onclick="adicionarLinha()">Adicionar Item</button>
    
    <div class="total">Total: R$ <span id="total">0.00</span></div>
    
    <div class="validade">Orçamento válido por 30 dias</div>

    <div style="text-align: center; margin-top: 30px;">
        <button onclick="gerarPDF()">Gerar Orçamento PDF</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Configurar data atual
        document.getElementById('data').value = new Date().toISOString().split('T')[0];

        function atualizarTotal() {
            let total = 0;
            document.querySelectorAll('#itens tbody tr').forEach(linha => {
                const preco = parseFloat(linha.querySelector('.preco').value) || 0;
                const quantidade = parseFloat(linha.querySelector('.quantidade').value) || 0;
                const subtotal = preco * quantidade;
                linha.querySelector('.subtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
                total += subtotal;
            });
            document.getElementById('total').textContent = total.toFixed(2);
        }

        function adicionarLinha() {
            const novaLinha = document.createElement('tr');
            novaLinha.innerHTML = `
                <td><input type="text" class="material"></td>
                <td><input type="number" class="preco" step="0.01"></td>
                <td><input type="number" class="quantidade" value="1"></td>
                <td class="subtotal">R$ 0.00</td>
                <td><button type="button" onclick="removerLinha(this)">×</button></td>
            `;
            document.querySelector('#itens tbody').appendChild(novaLinha);
            
            // Adicionar event listeners aos novos inputs
            novaLinha.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', atualizarTotal);
            });
        }

        function removerLinha(botao) {
            if(document.querySelectorAll('#itens tbody tr').length > 1) {
                botao.closest('tr').remove();
                atualizarTotal();
            }
        }

        // Adicionar event listeners aos inputs existentes
        document.querySelectorAll('#itens input').forEach(input => {
            input.addEventListener('input', atualizarTotal);
        });

        function gerarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Cabeçalho
            doc.setFontSize(18);
            doc.text("Orçamento", 105, 20, { align: 'center' });
            
            // Informações do cliente
            doc.setFontSize(12);
            doc.text(`Cliente: ${document.getElementById('cliente').value}`, 20, 30);
            doc.text(`Data: ${document.getElementById('data').value}`, 20, 38);
            
            // Itens
            let y = 50;
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text("Descrição", 20, y);
            doc.text("Preço Unitário", 70, y);
            doc.text("Quantidade", 120, y);
            doc.text("Subtotal", 150, y);
            
            doc.setFont(undefined, 'normal');
            y += 10;
            
            document.querySelectorAll('#itens tbody tr').forEach(linha => {
                const cols = linha.querySelectorAll('td');
                doc.text(cols[0].querySelector('input').value, 20, y);
                doc.text(`R$ ${parseFloat(cols[1].querySelector('input').value).toFixed(2)}`, 70, y);
                doc.text(cols[2].querySelector('input').value, 120, y);
                doc.text(cols[3].textContent, 150, y);
                y += 10;
            });
            
            // Total
            doc.setFont(undefined, 'bold');
            doc.text(`Total: R$ ${document.getElementById('total').textContent}`, 20, y + 10);
            
            // Validade
            doc.setFont(undefined, 'italic');
            doc.text("Orçamento válido por 30 dias", 105, y + 20, { align: 'center' });
            
            doc.save(`Orcamento_${document.getElementById('cliente').value}.pdf`);
        }
    </script>
</body>
</html>
